## 5.4 常见的坑


### 5.4.1 内存泄漏
如果不调用remove()方法，即使线程结束，线程局部变量的值仍然保持强引用，这可能导致内存泄漏。
特别是在使用线程池时，如果不清理线程局部变量，可能会导致内存持续增长。

### 5.4.2 数据共享
在线程池中，如果不正确地使用ThreadLocal，可能会导致数据在不同任务之间意外地共享。
为了避免这种情况，通常需要在任务执行前后分别调用set()和remove()方法，
或者在任务执行期间不使用ThreadLocal。

### 5.4.3 继承性
ThreadLocal变量不会从父线程继承到子线程。每个线程都有其自己的ThreadLocal变量副本。

### 5.4.4 性能开销
使用ThreadLocal可能会增加一定的性能开销，因为每个线程都需要维护自己的变量副本。因此，在不需要线程隔离的情况下，应避免使用ThreadLocal。